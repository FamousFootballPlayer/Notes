# 1. 简介

## 1. 并发存在的原因

在并发出现之前，计算机没有操作系统的概念，一台机器只能同时执行一道程序，占用所有的计算机资源，这样带来了如下问题：

1. 资源利用不充分，例如计算机在等待用户输入时，只能阻塞等待，无法进行其他工作。
2. 程序处理的吞吐量太差，在正在执行的程序处理完成之前只能等待，无法处理之后的程序。
3. 程序编写复杂，处理逻辑如果过大无法编写成多个程序进行交互。

因此加入了操作系统带来了如下好处：

1. 提高资源利用率
2. 赋予每个程序公平性，即不同的用户和程序对于计算机上的资源有着同等的使用权，而不是单道程序独占。
3. 提供便利性，较大的程序可以拆分为几个小程序协同操作。

因此出现了多进程。

## 2. 多线程存在的原因

在不支持线程的系统中，进程是资源分配与调度的基本单位，但是进程之间的交互对于资源的消耗很大（消耗大的主要原因是几个进行的PCB之间没有较大的关系，无法共享资源，只能再通过媒介或某些技术手段进行交互），然而需要多进程协同的情况也比较频繁。常见的进程间通信方式如下：

1. 匿名管道通信
2. 高级管道通信
3. 有名管道通信
4. 消息队列通信
5. 信号量通信
6. 共享内存通信
7. 信号通信
8. 套接字通信

除此之外，进程对于CPU的利用力度也相对较粗，也因此出现了线程。

线程相对于进程有如下优点：

1. 同一进程的线程之间共享内存，线程之间的协同更加轻量级。
2. 线程的调度粒度更加细，对CPU的利用更加充分
3. 同一进程的多个线程在没有协同的情况下独立执行，提高效率。

我们在代码中学习到的多线程，并且带来的各种问题也是由于线程的基本特性带来的。

线程同时带来了巨大的风险：

1. 安全性问题
   由于同一进程的线程之间是共享内存空间的，则极其容易出现在多线程环境下，调用统一函数，返回结果不一致的情况，即竞态条件。
2. 活跃性问题
   活跃性问题指的是某件事情最终会发生，但是这意味着有些事情无法立即发生或者在可接受的范围内发生，造成该问题的原因，例如死锁、饥饿、活锁等
3. 性能问题
   多线程存在着使用线程而引入的性能问题或瓶颈。如下几个方面：
   1. 线程调度而带来的上下文操作，频繁的上下文操作会带来极大的开销。
   2. 同步机制带来的瓶颈，多道程序使用同一同步接口，该接口就是瓶颈。

continue ..